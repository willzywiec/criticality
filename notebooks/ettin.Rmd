---
title : 'Ettin'
output : html_notebook
---

```{r, include = FALSE, warning = FALSE}

# initialize environment
if (!is.null(dev.list())) dev.off()
rm(list = ls())
cat('\014')

```

```{r, warning = FALSE}

library(remotes)

# install_github('willzywiec/criticality', auth_token = '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', quiet = TRUE)

library(criticality)

# set variable
ext.dir <- 'C:/Users/Will/Documents/GitHub/criticality/data'

# tabulate data
dataset <- Tabulate(
  ext.dir = ext.dir)

```

```{r, warning = FALSE}

# build metamodel
# metamodel <- Split(
#   dataset = dataset,
#   replot = FALSE,
#   ext.dir = '/Users/will/Desktop/example')

# build metamodel
metamodel <- NN(
  dataset = dataset,
  batch.size = 128,
  epochs = 10,
  ensemble.size = 1,
  replot = FALSE,
  training.dir = ext.dir)

```

```{r, warning = FALSE}

# set variable
facility <- 'facility'

# build Bayesian network
bn <- BN(
  facility = facility,
  ext.dir = ext.dir)

# estimate risk
risk <- Risk(
  bn = bn,
  dataset = dataset,
  dist = 'gamma',
  facility = facility,
  keff.cutoff = 0.5,
  metamodel = metamodel,
  risk.pool = 10,
  sample.size = 1e+05,
  ext.dir = ext.dir)

```
